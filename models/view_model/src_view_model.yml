version: 2

sources:
  - name: raw_data_test
    database: etl
    schema: dbt_test
    tables:
      - name: raw_data_test
  - name: mysql_default
    schema: raw_mysql_default
    tables:
      - name: company
        identifier: airbyte_company
        columns:
          - name: id
          - name: companyid
          - name: createdon
          - name: modifiedon
          - name: isadvance
          - name: isautorenew
  - name: mssql_accountapp_dbo
    schema: raw_mssql_accountapp_prod_dbo
    tables:
      - name: company
        description: FlowAccount users' company information
        columns:
          - name: id
          - name: createdon
          - name: modifiedon
          - name: isactive
          - name: isadvance
          - name: signupchannel
          - name: supportcode
          - name: useragent
          - name: isvat
  - name: stg_user_analytics_s3
    schema: dbt_staging_user_analytics
    tables:
      - name: stg_user_analytics_s3__raw_event
        description: Raw event records of all events and platforms
        columns:
          - name: record_id
            description: Unique event record identifier
            tests:
              - unique
              - not_null
          - name: event_id
            description: Event type identifier
            tests:
              - not_null
          - name: event_category
          - name: event_name
          # Timestamp
          - name: created_at
            description: Event occurence time
            tests:
              - not_null
          - name: updated_at
          # Actor
          - name: company_id
            description: Company causing this event
          - name: user_id
            description: User causing this event
          # Context
          - name: platform_id
            description: Platform which event happened
            tests:
              - not_null
          - name: application
          - name: platform
          - name: app_version
          - name: build_version
          - name: product_flavor
          - name: role_id
          - name: role_name
          - name: is_vat
          - name: is_subscribed
          - name: is_expired
          - name: company_type_id
          - name: company_type
          - name: company_type_category
          - name: company_type_tax
          - name: company_role
          - name: company_phone
          - name: company_mobile
          - name: company_fax
          - name: plan
          # Event payload
          - name: payload
          # ETL metadata
          - name: __etl_loaded_at
            description: Timestamp when this record is loaded
          - name: __etl_loader_type
          - name: __etl_loader_name
          - name: __etl_loader_job_id
  - name: user_analytics_s3
    schema: dbt_test
    tables:
      - name: stg_user_analytics_s3__raw_event
        description: Raw event records of all events and platforms
        columns:
          - name: record_id
            description: Unique event record identifier
            tests:
              - unique
              - not_null
          - name: event_id
            description: Event type identifier
            tests:
              - not_null
          - name: event_category
          - name: event_name
          # Timestamp
          - name: created_at
            description: Event occurence time
            tests:
              - not_null
          - name: updated_at
          # Actor
          - name: company_id
            description: Company causing this event
          - name: user_id
            description: User causing this event
          # Context
          - name: platform_id
            description: Platform which event happened
            tests:
              - not_null
          - name: application
          - name: platform
          - name: app_version
          - name: build_version
          - name: product_flavor
          - name: role_id
          - name: role_name
          - name: is_vat
          - name: is_subscribed
          - name: is_expired
          - name: company_type_id
          - name: company_type
          - name: company_type_category
          - name: company_type_tax
          - name: company_role
          - name: company_phone
          - name: company_mobile
          - name: company_fax
          - name: plan
          # Event payload
          - name: payload
          # ETL metadata
          - name: __etl_loaded_at
            description: Timestamp when this record is loaded
          - name: __etl_loader_type
          - name: __etl_loader_name
          - name: __etl_loader_job_id